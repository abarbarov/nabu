syntax = "proto3";

package protobuf;

message Project {
    int64 id = 1;
    string title = 2;
    string repository = 3;
}

message Repository {
    int64 id = 1;
    string name = 2;
    string key = 3;
    repeated Branch branches = 4;
}

message Branch {
    int64 id = 1;
    string name = 2;
    repeated Commit commits = 3;
}

message Commit {
    int64 id = 1;
    string message = 2;
    string sha = 3;
    int64 timestamp = 4;
}

service NabuService {
    rpc CreateProject (CreateProjectRequest) returns (ListProjectsResponse);
    rpc ListProjects (EmptyRequest) returns (stream ListProjectsResponse);
    rpc ListCommits (RepositoryRequest) returns (stream ListCommitsResponse);
}

message ListProjectsResponse {
    Project project = 1;
}

message ListCommitsResponse {
    Commit commit = 1;
}

message EmptyRequest {
}

message RepositoryRequest {
    string name = 1;
    string owner = 2;
    string branch = 3;
}

message CreateProjectRequest {
    string name = 1;
    Repository repository = 2;
}